<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veicular</title>
    <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
      max-width: 100%;
      background-color: #f4f4f4;
    
    }

    .container {
      max-width: 21cm; /* Largura da folha A4 */
      margin: 0 auto;
      background: white;
      padding: 1.2cm;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      box-sizing: border-box;
      
    }
    
h1, h3 {
  text-align: left;
  font-size: 0.8rem;
  margin-bottom: 1rem;
  color: #003366;
}
li {
  font-size: 0.8rem;
  margin-bottom: 0.4rem;
  text-align: left;
}
ol {
  padding-left: 0rem;
}

ul {
  padding-left: 0.2rem;
  margin-bottom: 0.5rem;
}

.field-group {
  margin-top: 1.5rem;
}

label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
  font-size: 0.9rem;
}

input[type="text"], input[type="date"] {
  width: 100%;
  padding: 6px;
  font-size: 0.9rem;
  margin-top: 4px;
  border: 1px solid #ccc;
  border-radius: 4px;
}
    .custom-header {
      margin-bottom: 2rem;
    }

    .header-content-wrapper {
      display: flex;
      border: 1px solid #000;
      width: 97%;
      max-width: 900px;
    }

    .header-main-content {
      flex-grow: 1;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 1rem;
      padding: 0.5rem 1rem;
      border-right: 1px solid #000;
    }

    .custom-header .logo-container img {
      max-height: 45px;
      width: auto;
    }

    .custom-header .title-container {
      text-align: center;
      color: #005a9c;
      font-weight: bold;
      font-size: 0.9rem;
      line-height: 1.2;
    }

    .custom-header .title-text {
      font-weight: bold;
      font-size: 0.8rem;
      color: #005a9c;
    }

    .custom-header .udlog-logo img {
      max-height:50px;
      width: auto;
    }

    .custom-header .info-table {
      display: flex;
      flex-direction: column;
    }

    .custom-header .info-table div {
      display: flex;
      align-items: center;
      border-bottom: 1px solid #000;
      padding: 0.2rem 0.5rem;
      font-size: 0.78rem;
      min-width: 110px;
      box-sizing: border-box;
    }

    .custom-header .info-table div:last-child {
      border-bottom: none;
    }

    h1 {
      text-align: center;
      font-size: 1.2rem;
    }

    .field-group {
      margin-top: 10px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 3px;
    }
    input[type="text"], input[type="date"] {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    canvas {
      border: 1px solid #000;
      margin-top: 1px;
    }
    .btn {
      margin-top: 2px;
      padding: 8px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .btn:hover {
      background-color: #0056b3;
    }
    textarea {
      width: 100%;
      resize: none;
    }


    @media print {
        body, html {
        margin: 0;
        padding: 0;
        width: 230mm;
        height: 297mm;
        background-color: white;
      }

      .no-print {
        display: none !important;
      }

      .container {
        width: 100%;
        max-width: none;
        margin: 0;
        box-shadow: none;
        padding: 1.5cm;
      }

      header, h2, label, input, textarea {
        color: #000 !important;
      }
    }

    </style>
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="container" id="printable-area" >

    <!-- cabeçario  -->
    <header class="custom-header">
      <div class="header-content-wrapper">
        <div class="header-main-content">
          <div class="udlog-logo">
            <img src="https://i.postimg.cc/sgCdvkCZ/udlog.png" alt="Logo UDLOG">
          </div>
          <div class="title-container">
            <p>TERMO DE RESPONSABILIDADE</p>
            <p>NO USO DE VEICULOS</p>
          </div>
          </div>
        <div class="info-table">
          <div>Código: FO.TI.006</div>
          <div>Revisão: 00</div>
          <div>Data: 10/04/2025</div>
          <div>Responsável: T.I.</div>
        </div>
      </div>
    </header>


    <h1>TERMO DE RESPONSABILIDADE NO USO DE VEÍCULOS</h1>
    <p>
      Pelo presente termo, declaro ciente, referente à utilização de veículos pertinentes à empresa UDLOG Armazéns Gerais Transporte e Logística, comprometendo-me a cumprir integralmente as condições estabelecidas para o uso, preservação e devolução dos mesmos.
    </p>

    <h3>Cláusulas do Termo:</h3>
    <ol>
      <li><strong>Uso do Veículo:</strong> 
        <ul>
        <li> O veículo será utilizado exclusivamente para atividades profissionais, sendo vedado o uso para fins pessoais, salvo autorização prévia e expressa da empresa.</li>
        </ul>
    </li>

      <li><strong>Responsabilidade por Danos e Avarias:</strong>
        <ul>
          <li>Declaro estar ciente de que qualquer dano, avaria ou acidente ocorrido no veículo, decorrente de negligência, imprudência ou uso indevido, será de minha responsabilidade.</li>
          <li>Danos alheios à minha conduta ou força maior serão analisados pela empresa.</li>
        </ul>
      </li>

      <li><strong>Cuidados com o Veículo:</strong>
        <ul>
          <li>Realizar o Checklist ao utilizar o veículo;</li>
          <li>Informar imediatamente à empresa quaisquer problemas ou avarias;</li>
          <li>Cumprir as leis de trânsito vigentes.</li>
        </ul>
      </li>

      <li><strong>Descontos por Danos:</strong> Autorizo descontos em minha remuneração (CLT), conforme art. 462 da CLT, por danos devidamente comprovados. Caso seja PJ, assumo a responsabilidade conforme contrato.</li>

      <li><strong>Devolução do Veículo:</strong> O veículo deverá ser devolvido em perfeitas condições, salvo desgaste natural.</li>

      <li><strong>Penalidades:</strong> O descumprimento das condições poderá acarretar sanções disciplinares ou rescisão contratual por justa causa.</li>
    </ol>

    <p>Declaro estar ciente e de acordo com as condições estabelecidas neste termo, bem como com as disposições legais aplicáveis.</p>

    <div class="field-group">
      <label for="nome">Nome completo:</label> 
      <input style="width: 300px" type="text" id="nomeFuncionario" />

      <label for="cargo">Cargo:</label>
      <input style="width: 300px" type="text" id="cargo" />

      <label for="departamento">Departamento:</label>
      <input style="width: 300px" type="text" id="departamento" />

      <label for="centro">Centro de Custo:</label>
      <input style="width: 150px" type="text" id="centro" />

      <label for="data">Data:</label>
      <input style="width: 85px"type="text" id="data" />
    </div>

<!-- Assinatura do Recebedor -->
  <div style="text-align: center;">
    <p><strong> Assinatura do usuario </strong></p>
    <div
    style="
        border: 1px solid #000;
        width: 555px;
        height: 146px;
        background-color: #fff;
        box-sizing: border-box;
        margin: 0 auto;
      "
    >
      <canvas
        id="AssinaturaUsuario"
        width="540px"
        height="130px"
        style="display: block; touch-action: none; user-select: none; border: none;"
        
      ></canvas>
          </div>
          
          <button
            type="button"
            onclick="limparCanvas('AssinaturaUsuario')"
            class="action-button no-print"
            style="margin-top: 10px;"
          >
            Limpar
          </button>
        </div>
      

 <!--E-mail usuario-->      
<div class="no-print"
 style="display: flex; flex-direction: column; align-items: center; gap: 10px; margin-bottom: 20px;" >
  <label for="email_colaborador" style="font-weight: bold; color: #333;">
    E-mail do colaborador:
  </label>
  <input
    type="email"
    id="email_colaborador"
    name="email_colaborador"
    style="
      width: 100%;
      width: 150px;
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
       text-align: center;
    "
    required
  />


      <!-- Botão PDF -->
      <div class="footer no-print">
        <button id="print-button" class="action-button">Enviar por e-mail</button>
      </div>
    </div>
    </div>

 <!-- fecha container -->

  <script>

    const printButton = document.getElementById('print-button');

    printButton.addEventListener('click', function () {
     //Desativa o botão após o clique
    printButton.disabled = true;
    printButton.innerText = 'Enviando...';
    });

     // javascript
//configurarAssinatura(idCanvas)
function configurarAssinatura(idCanvas) {
  const canvas = document.getElementById(idCanvas);
  const ctx = canvas.getContext("2d");
  let desenhando = false;

  function getPos(evt) {
    const rect = canvas.getBoundingClientRect();
    return {
      x: evt.clientX - rect.left,
      y: evt.clientY - rect.top
    };
  }

  canvas.addEventListener("mousedown", e => {
    desenhando = true;
    const pos = getPos(e);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
  });

  canvas.addEventListener("mousemove", e => {
    if (!desenhando) return;
    const pos = getPos(e);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
  });

  canvas.addEventListener("mouseup", () => desenhando = false);
  canvas.addEventListener("mouseleave", () => desenhando = false);

  canvas.addEventListener("touchstart", e => {
    e.preventDefault();
    const touch = e.touches[0];
    const pos = getPos(touch);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
    desenhando = true;
  });

  canvas.addEventListener("touchmove", e => {
    e.preventDefault();
    if (!desenhando) return;
    const touch = e.touches[0];
    const pos = getPos(touch);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
  });

  canvas.addEventListener("touchend", () => desenhando = false);
}

//limparCanvas(idCanvas)
function limparCanvas(idCanvas) {
  const canvas = document.getElementById(idCanvas);
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}

//Ao carregar a página, inicializa as áreas de assinatura
window.addEventListener('load', () => {
  configurarAssinatura("AssinaturaUsuario");
});

// gerar PDF
function gerarPDF() {
  const formClone = document.getElementById('printable-area').cloneNode(true);

  formClone.querySelectorAll('input, textarea').forEach(el => {
    if (el.type === 'checkbox') {
      if (el.checked) el.setAttribute('checked', 'checked');
      else el.removeAttribute('checked');
    } else if (el.tagName === 'TEXTAREA' || el.type === 'text') {
      el.setAttribute('value', el.value);
    }
  });

  
  const AssinaturaUsuario = document.getElementById('AssinaturaUsuario').toDataURL();

  const sig1 = document.createElement('img');
  sig1.src = AssinaturaUsuario;
  sig1.style.marginTop = '8px';

  formClone.querySelector('#AssinaturaUsuario').replaceWith(sig1);

  const finalHtml = `<!DOCTYPE html><html><head><meta charset='utf-8'><style>${document.querySelector('style').innerHTML}</style></head><body>${formClone.outerHTML}</body></html>`;

  const nomeFuncionario = document.getElementById("nomeFuncionario")?.value || "Funcionario";
  const emailColaborador = document.getElementById("email_colaborador")?.value || "";

        fetch("gerar_pdf_browsershot.php", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams({
            html: finalHtml,
            nome_funcionario: nomeFuncionario,
            email_colaborador: emailColaborador
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "ok") {
              Swal.fire({
                icon: "success",
                title: "PDF GERADO E ENVIADO!",
                text: "O termo foi salvo e enviado por e-mail com sucesso.",
                confirmButtonText: "OK",
              }).then(() => {
            // Quando o usuário fechar o popup:
            printButton.disabled = false;
            printButton.innerText = "Enviar por e-mail";
            });
            } else {
              throw new Error("Erro na geração ou envio do PDF.");
            }
          })
          
          .catch((error) => {
            console.error(error);
            Swal.fire({
              icon: "error",
              title: "Erro",
              text: "Ocorreu um erro ao gerar ou enviar o PDF.",
              confirmButtonText: "OK",
            });
          });         
      }
       

      document
        .getElementById("print-button")
        .addEventListener("click", gerarPDF);
    </script>
  </body>
</html>
